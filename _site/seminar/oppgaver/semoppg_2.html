<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Mikroøkonomi (SFB10816) – Seminar 2: Matematikk for mikroøkonomi</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-search-results"></div>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Seminar 2: Matematikk for mikroøkonomi</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#del-i-modeller-i-mikroøkonomi" id="toc-del-i-modeller-i-mikroøkonomi" class="nav-link active" data-scroll-target="#del-i-modeller-i-mikroøkonomi">Del I: Modeller i mikroøkonomi</a></li>
  <li><a href="#del-ii-brøkregning-og-derivasjon" id="toc-del-ii-brøkregning-og-derivasjon" class="nav-link" data-scroll-target="#del-ii-brøkregning-og-derivasjon">Del II: Brøkregning og derivasjon</a>
  <ul>
  <li><a href="#brøkregning" id="toc-brøkregning" class="nav-link" data-scroll-target="#brøkregning">Brøkregning</a></li>
  <li><a href="#derivasjon" id="toc-derivasjon" class="nav-link" data-scroll-target="#derivasjon">Derivasjon</a></li>
  <li><a href="#en-variabel" id="toc-en-variabel" class="nav-link" data-scroll-target="#en-variabel">En variabel</a></li>
  <li><a href="#to-variabler" id="toc-to-variabler" class="nav-link" data-scroll-target="#to-variabler">To variabler</a></li>
  <li><a href="#diffrensiering" id="toc-diffrensiering" class="nav-link" data-scroll-target="#diffrensiering">Diffrensiering</a></li>
  </ul></li>
  <li><a href="#del-iii-system-av-ligninger-og-lagranges-metode" id="toc-del-iii-system-av-ligninger-og-lagranges-metode" class="nav-link" data-scroll-target="#del-iii-system-av-ligninger-og-lagranges-metode">Del III: System av ligninger og Lagranges metode</a>
  <ul>
  <li><a href="#system-av-likninger" id="toc-system-av-likninger" class="nav-link" data-scroll-target="#system-av-likninger">System av likninger</a></li>
  <li><a href="#lagranges-metode" id="toc-lagranges-metode" class="nav-link" data-scroll-target="#lagranges-metode">Lagranges metode</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>Uke 5, ansvarlig: TAB Fredag kl. 12:15-14:00</p>
<section id="del-i-modeller-i-mikroøkonomi" class="level2">
<h2 class="anchored" data-anchor-id="del-i-modeller-i-mikroøkonomi">Del I: Modeller i mikroøkonomi</h2>
<ol type="a">
<li>) Hva menes med en økonomisk modell?
<p class="answer hidden">
En forenklet beskrivelse av virkeligheten. Bygger pr. definisjon på forutsetninger. Virkeligheten er kompliser, forenklingen gjør at vi kan rense vekk momenter som vi tror ikke har noen spesiell innvirkning på vårt spørsmål.
</p></li>
<li>) Hva er forskjellen mellom <em>eksogene</em> og <em>endogene</em> variabler i en økonomisk modell?
<p class="answer hidden">
I mikroøkonomi er endogene variable er de variablene som blir forklart av modellen. Eksogene variable er de variablen som inngår i modellen, men blir bestemt utenfor modellen.
</p></li>
<li>) Hva vil det si å utføre <em>komparativ stikk</em> i en økonomisk modell?
<p class="answer hidden">
Innebærer å analysere effekten av en isolert endring i en eller flere variabler (vanligvis ved bruk av derivasjon eller differensiering) i modellen og analysere hvordan dette påvirker de økonomiske resultatene.
</p></li>
</ol>
</section>
<section id="del-ii-brøkregning-og-derivasjon" class="level2">
<h2 class="anchored" data-anchor-id="del-ii-brøkregning-og-derivasjon">Del II: Brøkregning og derivasjon</h2>
<section id="brøkregning" class="level3">
<h3 class="anchored" data-anchor-id="brøkregning">Brøkregning</h3>
<p>Forenkl disse uttrykkene</p>
<ol type="a">
<li>) <span class="math display">\[x^2 \cdot x^3\]</span>
<p class="answer hidden">
<span class="math display">\[x^{2+3}=x^{5}\]</span>
</p></li>
<li>) <span class="math display">\[x \cdot x^4\]</span>
<p class="answer hidden">
<span class="math display">\[x^{1}x^{4}=x^{1+4}=x^{5}\]</span>
</p></li>
<li>) <span class="math display">\[y+y\]</span>
<p class="answer hidden">
<span class="math display">\[2y\]</span>
</p></li>
<li>) <span class="math display">\[y^{2} + y\]</span>
<p class="answer hidden">
<span class="math display">\[yy+y=y(y+1)\]</span>
</p></li>
<li>) <span class="math display">\[x_{1}^{0.5} \left(x_{1} + x_{2}\right)\]</span>
<p class="answer hidden">
<span class="math display">\[x_1^{0.5}x_1^1+x_1^{0.5}x_2^1=x_1^{1.5}+x_1^{0.5}x_2\]</span>
</p></li>
<li>) <span class="math display">\[\frac{1}{x_1} \cdot x_1^3\]</span>
<p class="answer hidden">
<span class="math display">\[\frac{x_1^{3}}{x_1^1}=x_1^{3-1}=x_1^{2}\]</span>
</p></li>
<li>) <span class="math display">\[\frac{x_{1}^{3}}{x_{2}^{3}}\]</span>
<p class="answer hidden">
<span class="math display">\[(\frac{x_1}{x_2})^{3}\]</span>
</p></li>
</ol>
<p>Løs for <span class="math inline">\(y\)</span>:</p>
<ol type="a">
<li>) <span class="math display">\[y^2 =a b\]</span>
<div class="answer hidden">
<p><span class="math display">\[\sqrt{y^2}=\sqrt{ab}\]</span> <span class="math display">\[y=\sqrt{ab}\]</span></p>
</div></li>
<li>) <span class="math display">\[y^{0.5}=a + b\]</span>
<div class="answer hidden">
<p><span class="math display">\[(y^{0.5})^2=(a+b)^2\]</span> <span class="math display">\[y=(a+b)^2\]</span></p>
</div></li>
</ol>
</section>
<section id="derivasjon" class="level3">
<h3 class="anchored" data-anchor-id="derivasjon">Derivasjon</h3>
</section>
<section id="en-variabel" class="level3">
<h3 class="anchored" data-anchor-id="en-variabel">En variabel</h3>
<p>Deriver med hensyn på <span class="math inline">\(x\)</span>:</p>
<ol type="a">
<li>) <span class="math display">\[4 x^{3}\]</span>
<div class="answer hidden">
<p><span class="math display">\[f'(x) = 12x^2 \]</span></p>
</div></li>
<li>) <span class="math display">\[4 x^{5} + \frac{2}{x^{3}}\]</span>
<div class="answer hidden">
<p><span class="math display">\[f'(x) = 20x^4-6x^{-4}\]</span></p>
</div></li>
<li>) <span class="math display">\[\frac{1}{6}x^6a\]</span>
<div class="answer hidden">
<p><span class="math display">\[f'(x) = x^5a\]</span></p>
</div></li>
<li>) <span class="math display">\[\frac{1}{6}x^6+a \]</span>
<div class="answer hidden">
<p><span class="math display">\[f'(x) = x^{5}\]</span></p>
</div></li>
<li>) <span class="math display">\[\frac{5x}{2x^2}\]</span>
<div class="answer hidden">
<p><span class="math display">\[f'(x) = \frac{52x^2-5x4x}{(2x^2)^2}=\frac{10x^2-20x^2}{(2x^4}=\frac{-5x}{2x^2}\]</span></p>
</div></li>
</ol>
</section>
<section id="to-variabler" class="level3">
<h3 class="anchored" data-anchor-id="to-variabler">To variabler</h3>
<p>Deriver med hensyn på <span class="math inline">\(x\)</span> og <span class="math inline">\(y\)</span>:</p>
<ol type="a">
<li>) <span class="math display">\[5 x^{4} + 3 y^{0.5}\]</span>
<div class="answer hidden">
<p><span class="math display">\[f'_x(x,y)=20x^3\]</span> <span class="math display">\[f'_y(x,y)=1.5y^{-0.5}\]</span></p>
</div></li>
<li>) <span class="math display">\[0.5 x^{0.5} + x y^{0.5}\]</span>
<div class="answer hidden">
<p><span class="math display">\[f'_x(x,y)=x+y^{0.5}\]</span> <span class="math display">\[f'_y(x,y)=0.5xy^{-0.5}\]</span></p>
</div></li>
<li>) <span class="math display">\[3x^{1/6}y^{2}+y^{1/3}x^{3}\]</span>
<div class="answer hidden">
<p><span class="math display">\[f'_x(x,y)=\frac{1}{2}x^{-5/6}y^2+3y^{1/3}x^2\]</span> <span class="math display">\[f'_y(x,y)=6x^{1/6}y+\frac{1}{3}y^{-2/3}x^3\]</span></p>
</div></li>
</ol>
<p>Deriver med hensyn på <span class="math inline">\(x_1\)</span> og <span class="math inline">\(x_2\)</span>:</p>
<ol type="a">
<li>) <span class="math display">\[3x_1^{1/6}+x_2^{1/3}\]</span>
<div class="answer hidden">
<p><span class="math display">\[f'_x(x_1,x_2)=\frac{1}{2}x_1^{-5/6}\]</span> <span class="math display">\[f'_y(x_1,x_2)=\frac{1}{3}x_2^{-2/3}\]</span></p>
</div></li>
</ol>
</section>
<section id="diffrensiering" class="level3">
<h3 class="anchored" data-anchor-id="diffrensiering">Diffrensiering</h3>
<p>Ta utgangspunkt i funksjonen <span class="math display">\[
\overline{x} = f(x_1,x_2)
\]</span> Hvor <span class="math inline">\(\overline{x}\)</span> er en konstant, og <span class="math inline">\(x_1\)</span> og <span class="math inline">\(x_2\)</span> er to variabler.</p>
<ol type="a">
<li>) Totaldifferensier uttrykket
<div class="answer hidden">
<p><span class="math display">\[\Delta \overline{x} = f'_{x_1}(x_1,x_2)\Delta x_1 + f'_{x_2}(x_1,x_2)\Delta x_2 = 0 \]</span></p>
</div></li>
<li>) Vis så at det er mulig å skrive dette som <span class="math display">\[
-\frac{\Delta x_{2}}{\Delta x_{1}}  = \frac{f'_{x_{1}}}{f'_{x_{2}}}
\]</span>
<div class="answer hidden">
<p><span class="math display">\[f'_{x_2}(x_1,x_2)\Delta x_2 =- f'_{x_1}(x_1,x_2)\Delta x_1 \]</span> <span class="math display">\[\frac{\Delta x_2}{\Delta x_1} = -\frac{f'_{x_1}(x_1,x_2)}{f'_{x_2}(x_1,x_2)}\]</span> <span class="math display">\[-\frac{\Delta x_2}{\Delta x_1} = \frac{f'_{x_1}(x_1,x_2)}{f'_{x_2}(x_1,x_2)}\]</span></p>
</div></li>
</ol>
</section>
</section>
<section id="del-iii-system-av-ligninger-og-lagranges-metode" class="level2">
<h2 class="anchored" data-anchor-id="del-iii-system-av-ligninger-og-lagranges-metode">Del III: System av ligninger og Lagranges metode</h2>
<section id="system-av-likninger" class="level3">
<h3 class="anchored" data-anchor-id="system-av-likninger">System av likninger</h3>
Løs systemet av likninger nedenfor for <span class="math inline">\(x_1\)</span> og <span class="math inline">\(x_2\)</span> <span class="math display">\[\begin{eqnarray*}
\frac{x_2}{x_1} = 2  \\
10x_{1}+5x_{2}=40
\end{eqnarray*}\]</span>
<div class="answer hidden">
<p>Vi kan løse det første uttrykket for <span class="math inline">\(x_2\)</span> <span class="math display">\[
x_2 = 2x_1  
\]</span> Ved å sette inn i det andre uttrykket og løse for <span class="math inline">\(x_1\)</span> <span class="math display">\[
10x_{1}+5(2x{_1})=40
\]</span> <span class="math display">\[
x_{1}=\frac{40}{20}=2
\]</span> Som deretter kan løses for <span class="math inline">\(x_2\)</span> ved å sette tilbake til det først (eller andre) uttrykket: <span class="math display">\[
x_2 = 2\cdot 2= 4  \\
\]</span></p>
</div>
</section>
<section id="lagranges-metode" class="level3">
<h3 class="anchored" data-anchor-id="lagranges-metode">Lagranges metode</h3>
<p>Anta at vi har at <span class="math inline">\(u(x_1,x_2)=10x_1x_2\)</span> og at <span class="math inline">\(10x_{1}+5x_{2}=40\)</span></p>
<ol type="a">
<li>) Vis ved bruk av Lagrange-metode at dette gir opphav til systemet av ligninger vist ovenfor
<div class="answer hidden">
<p>Maks <span class="math display">\[\begin{equation*}
u(x_1,x_2)=10x_1x_2
\end{equation*}\]</span> Gitt at <span class="math display">\[\begin{equation*}
10x_{1}+5x_{2}=40
\end{equation*}\]</span> Lagrangefunksjonen vil derfor være gitt ved <span class="math display">\[\begin{equation*}
L(x_1,x_2) = 10x_1x_2 - \lambda(10x_{1}+5x_{2}-40)
\end{equation*}\]</span> De to første ordens betingelsene vil være gitt ved: <span class="math display">\[\begin{eqnarray*}
L'_{x_1}=10x_2 - \lambda 10 = 0 \\
L'_{x_2}=10x_1 - \lambda 5 = 0
\end{eqnarray*}\]</span> Som sammen med budsjettbetingelsen gir oss to likninger til løsing av to ukjente, <span class="math inline">\(x_{1}\)</span>, <span class="math inline">\(x_{2}\)</span>: <span class="math display">\[\begin{eqnarray*}
\frac{x_2}{x_1} = 2  \\
10x_{1}+5x_{2}=40
\end{eqnarray*}\]</span></p>
</div></li>
</ol>
<button id="show-all-answers">
Vis svar
</button>
<p class="answer hidden">
</p>
<style>
  .answer {
    color: blue;
  }
</style>
<script>
const answerToggles = document.querySelectorAll(".answer");
const showAllButton = document.getElementById("show-all-answers");

showAllButton.addEventListener("click", () => {
  answerToggles.forEach(answer => {
    answer.classList.toggle("hidden");
  });
});
</script>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Jørn I. Halvorsen (jorn.i.halvorsen at hiof.no)</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>